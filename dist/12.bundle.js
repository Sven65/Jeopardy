(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{607:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(49),s=l(r),o=l(a(165)),u=l(a(164)),i=(l(a(166)),l(a(106)));function l(e){return e&&e.__esModule?e:{default:e}}var d=(0,o.default)({loader:function(){return a.e(11).then(a.t.bind(null,606,7))},loading:u.default}),c=(0,o.default)({loader:function(){return a.e(10).then(a.t.bind(null,605,7))},loading:u.default}),f=(0,o.default)({loader:function(){return a.e(9).then(a.t.bind(null,445,7))},loading:u.default}),h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={loader:{isLoading:!1},userEdit:{editError:"",buyColorError:"",boughtColor:!1,boughtColorSuccess:"",unsavedChanges:!1},user:{settings:{email:"",error:null}},showPasswordError:!1},a.handleInput=a.handleInput.bind(a),a.checkPasswordMatch=a.checkPasswordMatch.bind(a),a._checkHasUnsavedChanges=a._checkHasUnsavedChanges.bind(a),a._saveSettings=a._saveSettings.bind(a),a.passwordConfirmInput=s.default.createRef(),a.passwordInput=s.default.createRef(),a.currentPasswordInput=s.default.createRef(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;i.default.subscribe(function(){e.setState(i.default.getState())}),i.default.dispatch({type:"s/GET_USER_SETTINGS",data:{userToken:this.props.userToken}})}},{key:"_checkHasUnsavedChanges",value:function(){var e=this.state.user.settings.email!==this.state.emailInput&&void 0!==this.state.emailInput,t=""!==this.state.password&&void 0!==this.state.password&&""!==this.state.confirmPassword&&void 0!==this.state.confirmPassword,a=this.checkPasswordMatch();return e||t&&a}},{key:"handleInput",value:function(e){var t=this;this.setState(function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},e.target.name,e.target.value),function(){t.setState({showPasswordError:t.checkPasswordMatch(),userEdit:{unsavedChanges:t._checkHasUnsavedChanges()}})})}},{key:"validateEmail",value:function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}},{key:"checkPasswordMatch",value:function(e){return this.passwordInput.value===this.passwordConfirmInput.value}},{key:"_saveSettings",value:function(){i.default.dispatch({type:"s/SAVE_USER_SETTINGS",data:{userToken:this.props.userToken,newEmail:this.state.emailInput,password:this.state.password,confirmPassword:this.state.confirmPassword,currentPassword:this.state.currentPassword}})}},{key:"render",value:function(){var e=this,t=(!this.state.userEdit.unsavedChanges&&this.state.userEdit.editError,null!==this.state.user.settings.error),a=this.state.userEdit.unsavedChanges&&""!==this.currentPasswordInput.value,n=this.state.showPasswordError;return t?s.default.createElement("div",null,s.default.createElement("div",{className:"columns is-multiline user-settings is-error"},s.default.createElement("div",{className:"column is-12 no-hover"},s.default.createElement(c,null),s.default.createElement("h1",{className:"title"},"Failed to get user settings"),s.default.createElement("h2",{className:"subtitle"},this.state.user.settings.error)))):s.default.createElement("div",null,s.default.createElement("div",{className:"columns is-multiline user-settings"},s.default.createElement("div",{className:"column is-12 no-hover"},s.default.createElement(d,{id:"emailInput",name:"emailInput",required:"required",type:"email",label:"Email Address",onChange:this.handleInput,validateFunc:this.validateEmail,error:"Please enter a valid email",autoComplete:"off",defaultValue:this.state.user.settings.email})),s.default.createElement("div",{className:"column is-12 no-hover"},s.default.createElement(d,{id:"password",name:"password",required:"required",type:"password",label:"New Password",onChange:this.handleInput,showError:function(){return n},error:"Passwords don't match",autoComplete:"off",inputRef:function(t){return e.passwordInput=t}}),s.default.createElement(d,{id:"confirmPassword",name:"confirmPassword",required:"required",type:"password",label:"Confirm New Password",showError:function(){return n},error:"Passwords don't match",onChange:this.handleInput,autoComplete:"off",inputRef:function(t){return e.passwordConfirmInput=t}})),s.default.createElement("div",{className:"column is-12 no-hover padding-15 no-bottom-padding"},s.default.createElement(d,{id:"currentPassword",name:"currentPassword",required:"required",type:"password",label:"Current Password",onChange:this.handleInput,autoComplete:"off",inputRef:function(t){return e.currentPasswordInput=t}}),s.default.createElement("form",{className:"mdl-form gameBrowser-button-holder "+(a?"":"hidden")},s.default.createElement(f,{type:"button",name:"save",id:"saveButton",text:"Save",icon:"content-save",className:"btn-submit",onClick:this._saveSettings})))))}}]),t}();t.default=h}}]);